---
sidebar: sidebar 
permalink: ehc/aws/aws-guest-dr-requirements.html 
keywords: adminstrative, ESXi hosts, VMware vCenter, nsx, MS SQL, oracle, Veeam, cloud, aws, Amazon FSx, vmc 
summary: 'Cette section détaille les exigences d"accès et de configuration des ressources sur site, VMware Cloud et Amazon FSX ONTAP.' 
---
= De formation
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../../media/


link:aws-guest-dr-overview.html["Précédent : présentation – reprise après incident du stockage connecté à l'invité AWS"]

Cette section détaille les exigences d'accès et de configuration des ressources sur site, VMware Cloud et Amazon FSX ONTAP.



== Compétences et connaissances

Plusieurs compétences et informations sont nécessaires pour accéder à Cloud Volumes Service pour AWS :

* Accès et connaissance de votre environnement sur site VMware et ONTAP.
* Accès à VMware Cloud et AWS, et connaissance de cette solution.
* L'accès à AWS et Amazon FSX ONTAP et leurs connaissances.
* Connaissance des ressources SDDC et AWS
* Connaissance de la connectivité réseau entre vos ressources sur site et cloud.
* Connaissances approfondies des scénarios de reprise après incident
* Connaissance pratique des applications déployées sur VMware.




== Administration

Qu'ils interagissent avec les ressources sur site ou dans le cloud, les utilisateurs et les administrateurs doivent avoir la possibilité et les droits de provisionner ces ressources là où ils en ont besoin, selon leurs autorisations. L'interaction de vos rôles et de vos autorisations pour les systèmes sur site, notamment ONTAP et VMware, ainsi que vos ressources cloud, y compris VMware Cloud et AWS, est essentielle à la réussite du déploiement du cloud hybride.

Les tâches d'administration suivantes doivent être en place pour concevoir une solution de reprise après incident avec VMware et ONTAP sur site et VMware Cloud sur AWS et FSX ONTAP.

* Rôles et comptes permettant de provisionner les éléments suivants :
+
** Les ressources de stockage de ONTAP
** Machines virtuelles VMware, datastores, etc
** VPC AWS et groupes de sécurité


* Le provisionnement d'un environnement VMware sur site et d'un environnement ONTAP
* Environnement cloud VMware
* Un système de fichiers Amazon pour FSX pour ONTAP
* Connectivité entre votre environnement sur site et AWS
* Connectivité pour votre VPC AWS




== Sur site

L'environnement virtuel VMware inclut des licences d'hôtes ESXi, de VMware vCenter Server, de réseau NSX et d'autres composants, comme illustré dans la figure suivante. Toutes les licences sont proposées différemment, et il est important de comprendre comment les composants sous-jacents consomment la capacité disponible sous licence.

image:dr-vmc-aws-image2.png["Erreur : image graphique manquante"]



=== Hôtes ESXi

Dans un environnement VMware, les hôtes de calcul sont déployés avec ESXi. Lorsqu'elle est sous licence avec vSphere sur différents niveaux de capacité, les machines virtuelles peuvent tirer parti des processeurs physiques sur chaque hôte et des fonctionnalités autorisées applicables.



=== VMware vCenter

La gestion des hôtes ESXi et du stockage est l'une des nombreuses fonctionnalités mises à la disposition de l'administrateur VMware avec vCenter Server. À partir de VMware vCenter 7.0, trois éditions de VMware vCenter sont disponibles, en fonction de la licence :

* VCenter Server Essentials
* VCenter Server Foundation
* Standard du serveur vCenter




=== VMware NSX

VMware NSX fournit aux administrateurs la flexibilité requise pour activer des fonctionnalités avancées. Les fonctions sont activées en fonction de la version de NSX-T Edition sous licence :

* Professionnel
* Avancé
* Enterprise plus
* Bureau distant/succursale




=== NetApp ONTAP

Les licences avec NetApp ONTAP désignent la façon dont les administrateurs peuvent accéder à différentes fonctionnalités de stockage. Une licence est un enregistrement d'un ou plusieurs droits logiciels. L'installation de clés de licence, également appelées codes de licence, vous permet d'utiliser certaines fonctionnalités ou services sur votre système de stockage. Par exemple, ONTAP prend en charge tous les principaux protocoles client standard (NFS, SMB, FC, FCoE, iSCSI, Et NVMe/FC) via la licence.

Les licences de fonctions Data ONTAP sont émises sous forme de packages, chacun contenant plusieurs fonctions ou une seule fonctionnalité. Un package nécessite une clé de licence et l'installation de la clé vous permet d'accéder à toutes les fonctionnalités du package.

Les types de licence sont les suivants :

* *Licence verrouillée par un nœud.* l'installation d'une licence verrouillée par un nœud donne droit à la fonctionnalité sous licence d'un nœud. Pour que le cluster utilise la fonctionnalité sous licence, au moins un nœud doit être sous licence pour la fonctionnalité.
* *Licence maître/site.* Une licence maître ou site n'est pas liée à un numéro de série de système spécifique. Lorsque vous installez une licence de site, tous les nœuds du cluster ont droit à la fonctionnalité sous licence.
* *Licence de démonstration/temporaire.* une licence de démonstration ou temporaire expire après un certain temps. Cette licence vous permet d'essayer certaines fonctionnalités logicielles sans avoir à acheter de droits.
* *Licence de capacité (ONTAP Select et FabricPool uniquement).* une instance ONTAP Select est concédée sous licence en fonction de la quantité de données que l'utilisateur souhaite gérer. À partir de ONTAP 9.4, FabricPool nécessite une licence de capacité pour être utilisée avec un niveau de stockage tiers (par exemple, AWS).




=== NetApp SnapCenter

SnapCenter nécessite plusieurs licences pour permettre les opérations de protection des données. Le type de licence SnapCenter que vous installez dépend de votre environnement de stockage et des fonctionnalités que vous souhaitez utiliser. La licence SnapCenter Standard protège les applications, les bases de données, les systèmes de fichiers et les machines virtuelles. Avant d'ajouter un système de stockage à SnapCenter, vous devez installer une ou plusieurs licences SnapCenter.

Pour assurer la protection des applications, des bases de données, des systèmes de fichiers et des machines virtuelles, vous devez disposer d'une licence standard basée sur le contrôleur installée sur votre système de stockage FAS ou AFF, ou d'une licence standard basée sur la capacité, installée sur vos plateformes ONTAP Select et Cloud Volumes ONTAP.

Consultez les conditions préalables suivantes à la sauvegarde SnapCenter pour cette solution :

* Un partage de volume et SMB créé sur le système ONTAP sur site pour localiser la base de données sauvegardée et les fichiers de configuration.
* Relation SnapMirror entre le système ONTAP sur site et FSX ou CVO dans le compte AWS. Utilisé pour le transport de l'instantané contenant la base de données SnapCenter sauvegardée et les fichiers de configuration.
* Windows Server installé dans le compte cloud, soit sur une instance EC2, soit sur une VM dans le SDDC VMware Cloud.
* SnapCenter installé sur l'instance Windows EC2 ou le VM dans VMware Cloud.




=== MS SQL

Dans le cadre de cette validation, nous utilisons MS SQL pour démontrer la reprise sur incident.

Pour plus d'informations sur les meilleures pratiques avec MS SQL et NetApp ONTAP, vous pouvez suivre https://www.netapp.com/media/8585-tr4590.pdf["ce lien"^].



=== Oracle

Dans le cadre de cette validation, nous utilisons ORACLE pour démontrer la reprise sur incident. Pour plus d'informations sur les meilleures pratiques avec ORACLE et NetApp ONTAP, vous pouvez suivre https://www.netapp.com/media/8744-tr3633.pdf["ce lien"^].



=== Veeam

Dans le cadre de cette validation, nous utilisons Veeam pour démontrer la reprise sur incident. Pour plus d'informations sur les meilleures pratiques avec Veeam et NetApp ONTAP, vous trouverez ci-dessous https://www.veeam.com/wp-netapp-configuration-best-practices-guide.html["ce lien"^].



== Le cloud



=== AWS

Vous devez être en mesure d'effectuer les tâches suivantes :

* Déployer et configurer des services de domaine.
* Déployez ONTAP FSX en fonction des exigences des applications dans un VPC donné.
* Configurez le cloud VMware sur la passerelle de calcul AWS pour permettre le trafic depuis FSX ONTAP.
* Configurez un groupe de sécurité AWS pour permettre la communication entre VMware Cloud sur les sous-réseaux AWS et les sous-réseaux VPC AWS lors du déploiement du service FSX ONTAP.




=== Cloud VMware

Vous devez être en mesure d'effectuer les tâches suivantes :

* Configurer VMware Cloud sur un SDDC AWS




=== Vérification du compte Cloud Manager

Les ressources doivent être déployées avec NetApp Cloud Manager. Pour vérifier que vous pouvez effectuer les tâches suivantes :

* https://docs.netapp.com/us-en/cloud-manager-setup-admin/task-signing-up.html["Inscrivez-vous à Cloud Central"^] si ce n'est pas déjà fait.
* https://docs.netapp.com/us-en/cloud-manager-setup-admin/task-logging-in.html["Connectez-vous à Cloud Manager"^].
* https://docs.netapp.com/us-en/cloud-manager-setup-admin/task-setting-up-netapp-accounts.html["Configurez des espaces de travail et des utilisateurs"^].
* https://docs.netapp.com/us-en/cloud-manager-setup-admin/concept-connectors.html["Créer un connecteur"^].




=== Amazon FSX pour NetApp ONTAP

Une fois un compte AWS créé, vous devez pouvoir effectuer la tâche suivante :

* Créez un utilisateur d'administration IAM capable de provisionner Amazon FSX pour le système de fichiers NetApp ONTAP.




== Conditions préalables à la configuration

Étant donné les différentes topologies dont les clients disposent, cette section se concentre sur les ports nécessaires pour permettre la communication entre les ressources sur site et dans le cloud.



=== Points requis pour les ports et le pare-feu

Les tableaux suivants décrivent les ports qui doivent être activés dans l'ensemble de votre infrastructure.

Pour obtenir la liste plus complète des ports requis pour le logiciel Veeam Backup & Replication, suivez ces instructions https://helpcenter.veeam.com/docs/backup/vsphere/used_ports.html?zoom_highlight=port+requirements&ver=110["ce lien"^].

Pour obtenir une liste plus complète des ports requis pour SnapCenter, suivez la https://docs.netapp.com/ocsc-41/index.jsp?topic=%2Fcom.netapp.doc.ocsc-isg%2FGUID-6B5E4464-FE9A-4D2A-B526-E6F4298C9550.html["ce lien"^].

Le tableau suivant répertorie la configuration requise pour les ports Veeam pour Microsoft Windows Server.

|===
| De | À | Protocole | Port | Remarques 


| Serveur de sauvegarde | Serveur Microsoft Windows | TCP | 445 | Port requis pour le déploiement des composants Veeam Backup & Replication. 


| Proxy de sauvegarde |  | TCP | 6160 | Port par défaut utilisé par le service Veeam installer. 


| Référentiel de sauvegarde |  | TCP | 2500 à 3500 | Plage par défaut de ports utilisés comme canaux de transmission de données et pour la collecte de fichiers journaux. 


| Montez le serveur |  | TCP | 6162 | Port par défaut utilisé par le Data Mover Veeam. 
|===

NOTE: Pour chaque connexion TCP utilisée par un travail, un port de cette plage est affecté.

Le tableau suivant répertorie la configuration requise pour les ports Veeam pour Linux Server.

|===
| De | À | Protocole | Port | Remarques 


| Serveur de sauvegarde | Serveur Linux | TCP | 22 | Port utilisé comme canal de contrôle de la console vers l'hôte Linux cible. 


|  |  | TCP | 6162 | Port par défaut utilisé par le Data Mover Veeam. 


|  |  | TCP | 2500 à 3500 | Plage par défaut de ports utilisés comme canaux de transmission de données et pour la collecte de fichiers journaux. 
|===

NOTE: Pour chaque connexion TCP utilisée par un travail, un port de cette plage est affecté.

Le tableau suivant répertorie la configuration requise pour le port de Veeam Backup Server.

|===
| De | À | Protocole | Port | Remarques 


| Serveur de sauvegarde | Serveur vCenter | HTTPS, TCP | 443 | Port par défaut utilisé pour les connexions à vCenter Server. Port utilisé comme canal de contrôle de la console vers l'hôte Linux cible. 


|  | Microsoft SQL Server hébergeant la base de données de configuration Veeam Backup & Replication | TCP | 1443 | Port utilisé pour la communication avec Microsoft SQL Server sur lequel la base de données de configuration Veeam Backup & Replication est déployée (si vous utilisez une instance par défaut de Microsoft SQL Server). 


|  | Serveur DNS avec résolution de nom de tous les serveurs de sauvegarde | TCP | 3389 | Port utilisé pour la communication avec le serveur DNS 
|===

NOTE: Si vous utilisez vCloud Director, veillez à ouvrir le port 443 sur les serveurs vCenter sous-jacents.

Le tableau suivant répertorie la configuration requise pour le port de Veeam Backup Proxy.

|===
| De | À | Protocole | Port | Remarques 


| Serveur de sauvegarde | Proxy de sauvegarde | TCP | 6210 | Port par défaut utilisé par le service d'intégration Veeam Backup VSS pour créer un snapshot VSS au cours de la sauvegarde de partage de fichiers SMB. 


| Proxy de sauvegarde | Serveur vCenter | TCP | 1443 | Port de service Web VMware par défaut pouvant être personnalisé dans les paramètres de vCenter. 
|===
Le tableau suivant répertorie les exigences en matière de ports SnapCenter.

|===
| Type de port | Protocole | Port | Remarques 


| Port de gestion SnapCenter | HTTPS | 8146 | Ce port est utilisé pour la communication entre le client SnapCenter (l'utilisateur SnapCenter) et le serveur SnapCenter. Utilisé également pour la communication entre les hôtes du plug-in et le serveur SnapCenter. 


| Port de communication SMCore de SnapCenter | HTTPS | 8043 | Ce port est utilisé pour la communication entre le serveur SnapCenter et les hôtes sur lesquels les plug-ins SnapCenter sont installés. 


| Hôtes du plug-in Windows, installation | TCP | 135 février 445 | Ces ports sont utilisés pour la communication entre le serveur SnapCenter et l'hôte sur lequel le plug-in est installé. Les orifices peuvent être fermés après l'installation. De plus, Windows Instrumentation Services recherche les ports 49152 à 65535, qui doivent être ouverts. 


| Hôtes de plug-in Linux, installation | SSH | 22 | Ces ports sont utilisés pour la communication entre le serveur SnapCenter et l'hôte sur lequel le plug-in est installé. Les ports sont utilisés par SnapCenter pour copier les binaires du package vers les hôtes du plug-in Linux. 


| Package de plug-ins SnapCenter pour Windows/Linux | HTTPS | 8145 | Ce port est utilisé pour la communication entre SMCore et les hôtes sur lesquels les plug-ins SnapCenter sont installés. 


| Port du serveur VMware vSphere vCenter | HTTPS | 443 | Ce port est utilisé pour la communication entre le plug-in SnapCenter pour VMware vSphere et le serveur vCenter. 


| Plug-in SnapCenter pour port VMware vSphere | HTTPS | 8144 | Ce port est utilisé pour les communications à partir du client Web vCenter vSphere et du serveur SnapCenter. 
|===
link:aws-guest-dr-networking.html["Suivant : la mise en réseau."]
